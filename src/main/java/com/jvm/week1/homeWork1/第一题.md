# 基本类型，四则运行，`if` 和 `for`的例子

## **源码**

```java
public class HelloByteCode{
    public static void main(String[] args) {
        int a = 0;
        int b = 1;
        for(int i = 0; i < 2; i++){

            if(i == 1){
                a *= b;
            }else{
                a += b;
            }
        }
    }
}
```

## **字节码反编译**

第`1-2`行：`iconst_0` 压入数字`0`到操作数栈，`istore_1` 将数字`0`从操作数栈放到本地变量表位置`1`上(a = 0)

第`3-4`行：`iconst_1`压入数字`1`到操作数栈，`istore_2`将数字`1`从操作数栈放到本地变量表位置`2`上(b = 1)

第`5-6`行：`iconst_0`压入数字`0`到操作数栈，`istore_3`将数字`0`从操作数栈放到本地变量表位置`3`上(i = 0)

第`7-8`行：`iload_3`将本地变量表位置`3`的数字`0`，压入到操作数栈上，`iconst_2`将数字`2`要入到操作数栈上

第`9`行：`if_icmpge`表示 `比较栈顶的2个int值决定分支(判断次顶值大于等于栈顶值)`

这里就是比较数字`2`是否大于或者等于`0`

满足走`33`，`return`结束

当然这里是不满足，接着往下走，判断完成后伴随着两个数字的**出栈**操作

第`10-11`行：`iload_3`加载本地变量表位置`3`的数字`0`到操作数栈上，`iconst_1`将数字`1`压入操作数栈上

第`12`行：`if_icmpne` 表示`比较栈顶的2个int值决定分支(判断两个值不相等)`

判断数字`0`与数字`1`不想等，满足走索引`23`

第`18-19`行：`iload_1`将本地变量表位置`1`的数字`0`入栈，`iload_2`将本地变量表位置`2`的数字`1`入栈

第`20`行：`iadd` 表示 `将栈顶的2个 int 值取出,相加(Add int),并将结果压入栈顶`

数字`1` 加数字`0`

第`21`行：`istore_1`将操作栈中的数字`1` 存放到本地变量表（a = 1）

第`22`行：`iinc 3,1`将局部变量表位置`3`的数字`+1`（i = 1）

第`23`行：`goto 6`去偏移量`6`

第`7-8`行：`iload_3`将本地变量表位置`3`的数字`1`，压入到操作数栈上，`iconst_2`将数字`2`要入到操作数栈上

第`9`行：`if_icmpge`表示 `比较栈顶的2个int值决定分支(判断次顶值大于等于栈顶值)`

这里就是比较数字`2`是否大于或者等于`1`

满足走`33`，`return`结束

这里不满足往下走，两个数字**出栈**操作

第`10-11`行：`iload_3`加载本地变量表位置`3`的数字`1`到操作数栈上，`iconst_1`将数字`1`压入操作数栈上

第`12`行：`if_icmpne` 表示`比较栈顶的2个int值决定分支(判断两个值不相等)`

判断数字`1`与数字`1`不想等，满足走索引`23`，

不满足往下走

第`13-14`行：`iload_1`加载本地变量表位置`1`的数字`1`到操作数栈上，`iload_2`加载本地变量表位置`2`的数字`1`到操作数栈上

第`15`行：`imul` 表示 `将栈顶的2个 int 值取出,相乘(Multiply int),并将结果压入栈顶`

也就是`1*1`

第`16`行：`istore_1`将数字`1`压入本地变量表位置`1`（a = 1）

第`17`行：`goto 27`去偏移量`27`

第`22`行：`iinc 3, 1` 本地变量表位置`3`自增`1`(i = 2)

第`23`行：`goto 6`去偏移量`6`

第`7-8`行：`iload_3`将本地变量表位置`3`的数字`2`，压入到操作数栈上，`iconst_2`将数字`2`要入到操作数栈上

第`9`行：``if_icmpge`表示 `比较栈顶的2个int值决定分支(判断次顶值大于等于栈顶值)`

这里就是比较数字`2`是否大于或者等于`2`

满足走偏移量`33`，`return`

[![Lj8s9U.png](https://s1.ax1x.com/2022/04/28/Lj8s9U.png)](https://imgtu.com/i/Lj8s9U)

**本地变量表**

```java
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            6      27     3     i   I
            0      34     0  args   [Ljava/lang/String;
            2      32     1     a   I
            4      30     2     b   I
```




